{% extends 'base.html' %}
{%load filter_functions%}
{% block content %}

<div class="p-5">
    <h1>Listado de departamentos</h1>
    <div class="input-group mb-3">
      <span class="input-group-text" id="basic-addon1"><i class="fa-solid fa-magnifying-glass"></i></span>
      <input type="text" class="form-control" id="search-departamento" placeholder="Username" aria-label="Buscar departamento" aria-describedby="basic-addon1">
  </div>
    <table class="table table-striped table-responsive">
        <thead class="table-dark">
            <th class="col-1">Numero</th>
            <th class="col-1">Codigo</th>
            <th>Nombre</th>
            <th></th>
        </thead>
        <tbody id="table-body">
    {%for object in object_list%}
            <tr>
                <td>{{forloop.counter}}</td>
                <td>{{object.codigo}}</td>
                <td>{{object.nombre}}</td>
                <td><button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#exampleModal-{{object.pk}}">
  Municipios
</button></td>
            </tr>
    {%endfor%}
    </tobdy>
    </table>

</div>

{%for object in object_list%}
<div class="modal fade" id="exampleModal-{{object.pk}}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Municipios</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            
            <table class="table">
                <thead class="table-dark">
                    <th>ID</th>
                    <th>Nombre</th>
                </thead>
                <tbody>
                    {%muestra_municipios object.pk%}
                </tbody>

            </table>

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary">Save changes</button>
        </div>
      </div>
    </div>
  </div>
{%endfor%}

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const searchProducto = document.getElementById("search-departamento");
    const tableBody = document.getElementById("table-body");

    searchProducto.addEventListener("input", function () {
      const searchTerm = this.value.trim().toLowerCase();
      const rows = tableBody.querySelectorAll("tr");

      rows.forEach((row) => {
        const productoName = row
          .querySelector("td:nth-child(3)")
          .textContent.toLowerCase();
        if (productoName.includes(searchTerm)) {
          row.style.display = "table-row";
        } else {
          row.style.display = "none";
        }
      });
    });
  });

</script>
{% endblock %}